@{
    ViewData["Title"] = "Winkelmandje";
    Layout = "~/Views/Shared/_Layout.cshtml";
}

<section class="max-w-6xl mx-auto px-4 py-10">
    <h2 class="text-3xl font-bold mb-6 text-center">ðŸ›’ Jouw Winkelmandje</h2>

    <div id="cartItems" class="space-y-4">
        <!-- JavaScript vult dit dynamisch -->
    </div>

    <div class="text-right mt-8">
        <p class="text-xl font-semibold">Totaal: <span id="totaalPrijs">â‚¬0.00</span></p>
        <a href="/Bestellen" class="bg-green-600 hover:bg-green-700 text-white py-3 px-6 rounded mt-4 inline-block">Bestelling Plaatsen</a>
    </div>
</section>

<script>
    let winkelmandje = JSON.parse(localStorage.getItem("winkelmandje") || "[]");

    function updateCartUI() {
        const container = document.getElementById("cartItems");
        const totaalField = document.getElementById("totaalPrijs");
        container.innerHTML = "";

        let totaal = 0;

        if (winkelmandje.length === 0) {
            container.innerHTML = "<p class='text-center text-gray-500'>Je winkelmandje is leeg.</p>";
            totaalField.innerText = "â‚¬0.00";
            return;
        }

        winkelmandje.forEach((item, index) => {
            totaal += item.prijs * item.aantal;

            const div = document.createElement("div");
            div.className = "bg-white p-4 rounded shadow flex justify-between items-center";

            div.innerHTML = `
                <div>
                    <h4 class="text-lg font-bold">${item.naam}</h4>
                    <p class="text-sm text-gray-600">Formaat: ${item.formaat}</p>
                    <p class="text-sm text-gray-600">Prijs: â‚¬${item.prijs.toFixed(2)}</p>
                    <label>Aantal: <input type="number" min="1" value="${item.aantal}" onchange="updateAantal(${index}, this.value)" class="w-16 border ml-2 px-1 py-0.5 rounded"/></label>
                </div>
                <button onclick="verwijderItem(${index})" class="text-red-600 font-semibold hover:underline">Verwijderen</button>
            `;
            container.appendChild(div);
        });

        totaalField.innerText = `â‚¬${totaal.toFixed(2)}`;
    }

    function verwijderItem(index) {
        winkelmandje.splice(index, 1);
        localStorage.setItem("winkelmandje", JSON.stringify(winkelmandje));
        updateCartUI();
    }

    function updateAantal(index, value) {
        winkelmandje[index].aantal = parseInt(value) || 1;
        localStorage.setItem("winkelmandje", JSON.stringify(winkelmandje));
        updateCartUI();
    }

    updateCartUI();
</script>
